<!DOCTYPE html>
<html>
<head>
	{% load staticfiles %}
	<title>SpartaHack Data Visualization</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	<script src="{{ STATIC_URL }}js/Chart.js" type="text/javascript"></script>
</head>
<body>
	<div class = "container-fluid">
		<div class = "row">
			<div class = " col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<center><h1>Better Than the Default TypeForm Report</h1></center>
			</div>
		</div>
		<div class = "row">
			<div class = " col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<center>
					<table class = "table-striped">
						<thead>
							<tr>
								<th onclick="sortBy('name');" >School Name</th>
								<th onclick="sortBy('number');">Number of People</th>
							</tr>
						</thead>
						<tbody id = "data"></tbody>
					</table>
				</center>
			</div>
		</div>
		
		<div id='mod3_chart'>
			<h4 style="color: black; padding-top: 8px;">Distribution by Birth Month</h4>
			<div><canvas id="myChart" height='300px' width='500px'></canvas></div>
		</div>
	</div>
	<script type="text/javascript">
		window.listOfColleges = [
			{%for key, value in colleges.items%}
			{"school":"{{key}}", "number":{{value}}},
			{%endfor%}
		];

		total = {{total}};
		function sortBy(thing){
			if(thing == "number"){
				window.listOfColleges.sort(function(a, b) { 
				    return b.number - a.number;
				})
			}
			if(thing == 'name'){
				window.listOfColleges.sort(function(a, b){
					if(a.school < b.school) return -1;
					if(a.school > b.school) return 1;
				})
			}
			var strToAdd = "";
			$(window.listOfColleges).each(function(i,e,a){
				if(parseInt(e.number) >14){
					strToAdd += "<tr><td class = 'school' style='padding-right:15px'><strong>"+e.school+"</strong></td><td class = 'number'><strong>"+e.number+"</strong></td></tr>";
				} else {
					strToAdd += "<tr><td class = 'school' style='padding-right:15px'>"+e.school+"</td><td class = 'number'>"+e.number+"</td></tr>";
				}
			});
			strToAdd += "<tr><td class = 'school' style='padding-right:15px'><strong>Total</strong></td><td class = 'number'><strong>"+total+"</strong></td></tr>"
			$("#data").html(strToAdd);

		}

		months = [
			{%for key, value in months.items%}
			["{{key}}",{{value}}],
			{%endfor%}
		];
		months.sort(function(a, b) { 
			return a[0] - b[0];
		})

		// chartjs bar graph for birth months
		var data = {
		    labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
		    datasets: [
		        {
		            label: "Distribution by Birth Month",
		            fillColor: "rgba(151,187,205,0.5)",
		            strokeColor: "rgba(151,187,205,0.8)",
		            highlightFill: "rgba(151,187,205,0.75)",
		            highlightStroke: "rgba(151,187,205,1)",
		            data: [months[0][1], months[1][1], months[2][1], months[3][1], months[4][1], months[5][1], months[6][1], months[7][1], months[8][1], months[9][1], months[10][1], months[11][1]]
		        }
		    ]
		};
		var ctx = document.getElementById("myChart").getContext("2d");
		var myBarChart = new Chart(ctx).Bar(data);

		$(document).ready(function(){
			sortBy('name');
		}); 
	</script>
</body>
</html>

